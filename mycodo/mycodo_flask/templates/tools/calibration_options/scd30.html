{% extends "layout.html" %}
{% set active_page = "calibration" %}
{% block title %} - {{_('Calibration & Setup')}}: Sensirion SCD30{% endblock %}

{% block head %}

{% endblock %}

{% block body %}
  <!-- Route: /setup_ds_resolution -->
  <div class="container">
    {% include 'flash_messages.html' %}

  <h2>Sensirion SCD30 Setup</h2>

  {% if ui_stage == 'start' %}

  <p>Set the temperature offset and measurement interval of the Sensirion SCD30 sensor. This setting will be written to the Sensor. Be sure to deactivate the sensor prior to calibration.</p>

    <form method="post" action="/setup_scd30">
    <div class="row small-gutters">
      <div class="col-auto">
        Measured Temperature at SCD30:
      </div>
      <div class="col-auto">
        {{'%0.2f'| format(temperature_scd30|float)}}°C
      </div>
    </div>
    <div class="row small-gutters">
      <div class="col-auto">
        Current Temperature offset at SCD30:
      </div>
      <div class="col-auto">
        {{'%0.2f'| format(temperature_offset|float)}}°C
      </div>
    </div>
    <div class="row small-gutters">
      <div class="col-auto">
        {{form_scd30.ambient_temperature.label(class_='control-label')}}
        <div>
        {{form_scd30.ambient_temperature(class='form-control')}}
        </div>
      </div>
      <div class="col-auto">
        {{form_scd30.calibrate_temperature(class_='form-control btn-default')}}
      </div>
    </div>
    </form>

    {% elif ui_stage == 'complete' %}

    <p>{{dict_translation['calibration']['title']}}{% if input_device_name %}: {{input_device_name}}{% endif %} {{selected_input.id}} ({{selected_input.name}}): {% if complete_with_error %}{{_('Calibration Failed')}}{% else %}{{_('Calibration Succeeded')}}{% endif %}</p>

      {% if complete_with_error %}
    <p>
      {{dict_translation['error']['title']}}:
      <br>{{complete_with_error}}
    </p>
    <p>{{_('Refer to the logs for details')}}</p>
      {% else %}
    <p>{{_('Calibration Complete')}}</p>
      {% endif %}

    {% endif %}

  </div>

{% endblock %}
